title = "Home"
url = "/"
layout = "default"

[Gallery]
markup = "user"
idGallery = "_home"
==
function onStart()
{
    $sub_dir = "home_page/";
    $files = array();
    $path = './storage/app/media/' . $sub_dir;
    $dir = opendir($path);

    while(false != ($file = readdir($dir))) {
        if(str_contains(strtolower($file), '.jpg') or str_contains(strtolower($file), '.jpeg')) {
            $files[] = $path . $file; // put in array.
        }
    }
    closedir($dir);
    $this->page["photoFiles"] = $files;
}
==
<body>
    <head>
        <!-- jQuery 1.8 or later, 33 KB -->
        <!-- <script rel="preload" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script> -->

        <link  rel="preload" href="{{ '/assets/css/lightslider.css'|theme }}" rel="stylesheet">
        <script rel="preload" src="{{ '/assets/javascript/lightslider.js'|theme }}"></script> 
        <script rel="preload" src="{{ '/assets/javascript/project-common.js'|theme }}"></script>            

    </head>

    <div id="container">
        <div id="cycler"> </div>
    </div>

    <div class="js-files" data-is-authenticated="{{ gallery.images|json_encode|e('html_attr') }}">
        <!-- ... -->
    </div>

    <scripts>

        <!-- <script> document.addEventListener("touchstart", function(e) {
            console.log(e.defaultPrevented);  // will be false
            e.preventDefault();   // does nothing since the listener is passive
            console.log(e.defaultPrevented);  // still false
        });
        </script> -->

        <script> loadImages('.js-files', 'cycler') </script>

        <script type="text/javascript">
            function cycleImages(){
                var $active = $('#cycler .active');
                var $next = ($active.next().length > 0) ? $active.next() : $('#cycler img:first');
                $next.css('z-index',2);//move the next image up the pile
                var img_src = $next[0].dataset.src;
                if($next[0].src == "") {
                        $next[0].setAttribute('src', img_src);//make the next image the top one
                    }
                $active.fadeOut(1500,function(){//fade out the top image
                    $active.css('z-index',1).show().removeClass('active');//reset the z-index and unhide the image
                    
                    $next.css('z-index',3).addClass('active');//make the next image the top one
                    
                    
                });
                }
        
            $(document).ready(function(){
            // run every 4s
            setInterval('cycleImages()', 7000);
            })</script>
            
    </scripts>
</body>