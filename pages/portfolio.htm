title = "PORTFOLIO"
url = "/portfolio"
layout = "inner-scroll"
==
function onStart()
{
    session_start();
    $sub_dir = "";
    $files = array();
    $path = './storage/app/media/' . $sub_dir;
    $dir = opendir($path);

    while(false != ($file = readdir($dir))) {
        if(!str_contains(strtolower($file), '.jpg') and !str_contains(strtolower($file), '.jpeg') and !str_contains(strtolower($file), 'home') and !str_contains(strtolower($file), 'core') and strlen($file) > 3) {
            $temp_path = $path . $file; // put in array.
            $temp_dir = opendir($temp_path);
            
            $flag = true;
            // Look through subdirectory to get either cover.jpg or the first image from the directory
            while(false != ($sub_file = readdir($temp_dir))) {
                if((str_contains(strtolower($sub_file), '.jpg') or str_contains(strtolower($sub_file), '.jpeg')) and str_contains(strtolower($sub_file), 'cover')) {
                    $files[] = $temp_path . '/' . $sub_file; // put in array.
                    $names[] = $file;
                    $flag = false;
                }
            }
            
            if($flag) {
                $sub_files = scandir ($temp_path);
                $files[] = $temp_path . '/' . $sub_files[2];
                $file = str_replace("_", " ", $file);
                $names[] = $file;
            }
            
            
        }
    }
    closedir($dir);
    $this->page["photoFiles"] = [$files, $names];
}
==

<head>
    <!-- jQuery 1.8 or later, 33 KB -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

    <!-- Fotorama from CDNJS, 19 KB -->
    <!-- <link  href="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.css" rel="stylesheet"> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.js"></script> -->
    <!-- <link  href="{{ '/assets/css/fotorama.dev.css'|theme }}" rel="stylesheet"> -->
    <!-- <script src="{{ '/assets/javascript/fotorama.dev.js'|theme }}"></script> -->

    <link  href="{{ '/assets/css/lightslider.css'|theme }}" rel="stylesheet">
    <script src="{{ '/assets/javascript/lightslider.js'|theme }}"></script>            
    <script src="{{ '/assets/javascript/project-common.js'|theme }}"></script>            
</head>

<body>
       <div id="aggregator"></div>
</body>

<div class="js-files" data-is-authenticated="{{ this.page.photoFiles|json_encode|e('html_attr') }}">
    <!-- ... -->
</div>

<div class="gallery" data-is-authenticated="{{ 'gallery'|page }}">
    <!-- ... -->
</div>


<scripts>

    <script> loadPortfolioCovers('.js-files', 'gallery', 'aggregator') </script>

    <script type="text/javascript">
        $('.box-wrapper').each(function(index, element) {

    setTimeout(function(){
        element.classList.remove('loading');
    }, index * 500);

    });
    </script>

</scripts>